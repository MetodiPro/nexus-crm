{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS users ( id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT UNIQUE NOT NULL, password TEXT NOT NULL, role TEXT NOT NULL, name TEXT NOT NULL, email TEXT, last_login DATETIME, failed_login_attempts INTEGER DEFAULT 0, account_locked BOOLEAN DEFAULT 0, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP )","service":"nexus-db","timestamp":"2025-06-24T10:44:09.997Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS clients ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, surname TEXT NOT NULL, company TEXT, vat_number TEXT, address TEXT, city TEXT, postal_code TEXT, phone TEXT, email TEXT, notes TEXT, consultant_id INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T10:44:09.999Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS activities ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, title TEXT NOT NULL, description TEXT, activity_date DATETIME NOT NULL, status TEXT DEFAULT 'pending', consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T10:44:10.000Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS products ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, description TEXT, energy_type TEXT NOT NULL, supplier TEXT, base_price REAL, is_active INTEGER DEFAULT 1, created_by INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (created_by) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T10:44:10.000Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS contracts ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, product_id INTEGER, contract_type TEXT NOT NULL, energy_type TEXT NOT NULL, supplier TEXT, status TEXT DEFAULT 'pending', value REAL, start_date DATE, end_date DATE, notes TEXT, consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (product_id) REFERENCES products (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T10:44:10.001Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS user_sessions ( id INTEGER PRIMARY KEY AUTOINCREMENT, user_id INTEGER NOT NULL, session_id TEXT NOT NULL, ip_address TEXT, user_agent TEXT, login_time DATETIME DEFAULT CURRENT_TIMESTAMP, logout_time DATETIME, is_active BOOLEAN DEFAULT 1, FOREIGN KEY (user_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T10:44:10.001Z"}
{"level":"debug","message":"Database query executed","method":"get","query":"SELECT * FROM users WHERE username = 'admin'","service":"nexus-db","timestamp":"2025-06-24T10:44:10.057Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["admin"],"query":"SELECT * FROM users WHERE LOWER(username) = LOWER(?)","service":"nexus-db","timestamp":"2025-06-24T10:44:25.480Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET failed_login_attempts = 0, account_locked = 0 WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:44:25.762Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET last_login = CURRENT_TIMESTAMP WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:44:25.763Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:44:25.775Z"}
{"level":"debug","message":"Database query executed","method":"run","params":["uKCUb3tyQKPMjQiepBr-MdUAD_K3sOek",8],"query":"UPDATE user_sessions SET session_id = ? WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:44:25.791Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:44:28.093Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, electricity_pod, electricity_supplier, gas_pdr, gas_supplier, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T10:44:28.095Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:44:30.404Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:48:46.224Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT a.*, c.name as client_name, c.surname as client_surname FROM activities a JOIN clients c ON a.client_id = c.id ORDER BY a.activity_date DESC","service":"nexus-db","timestamp":"2025-06-24T10:48:46.226Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:48:47.826Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:48:47.832Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["2025-06-24"],"query":"SELECT a.*, c.name as client_name, c.surname as client_surname FROM activities a JOIN clients c ON a.client_id = c.id WHERE date(a.activity_date) = date(?) ORDER BY a.activity_date ASC","service":"nexus-db","timestamp":"2025-06-24T10:48:47.833Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:48:49.547Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, electricity_pod, electricity_supplier, gas_pdr, gas_supplier, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T10:48:49.548Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:48:51.682Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:48:51.683Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM activities WHERE client_id = ? ORDER BY activity_date DESC","service":"nexus-db","timestamp":"2025-06-24T10:48:51.684Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT co.*, p.name as product_name FROM contracts co LEFT JOIN products p ON co.product_id = p.id WHERE co.client_id = ? ORDER BY co.created_at DESC","service":"nexus-db","timestamp":"2025-06-24T10:48:51.685Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:49:04.590Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT co.*, c.name as client_name, c.surname as client_surname, p.name as product_name, p.supplier as product_supplier FROM contracts co JOIN clients c ON co.client_id = c.id LEFT JOIN products p ON co.product_id = p.id ORDER BY co.created_at DESC","service":"nexus-db","timestamp":"2025-06-24T10:49:04.591Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:49:07.168Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT co.*, c.name as client_name, c.surname as client_surname, p.name as product_name, p.supplier as product_supplier, p.base_price as product_base_price, p.description as product_description FROM contracts co JOIN clients c ON co.client_id = c.id LEFT JOIN products p ON co.product_id = p.id WHERE co.id = ?","service":"nexus-db","timestamp":"2025-06-24T10:49:07.169Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:49:12.413Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT co.*, c.name as client_name, c.surname as client_surname, p.name as product_name, p.supplier as product_supplier, p.base_price as product_base_price, p.description as product_description FROM contracts co JOIN clients c ON co.client_id = c.id LEFT JOIN products p ON co.product_id = p.id WHERE co.id = ?","service":"nexus-db","timestamp":"2025-06-24T10:49:12.414Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, electricity_pod, electricity_supplier, gas_pdr, gas_supplier, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T10:49:12.414Z"}
{"level":"debug","message":"Database query executed","method":"all","query":"SELECT * FROM products ORDER BY name ASC","service":"nexus-db","timestamp":"2025-06-24T10:49:12.415Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:49:45.599Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT energy_type, COUNT(*) as count, SUM(value) as total_value FROM contracts WHERE status = 'accepted' GROUP BY energy_type","service":"nexus-db","timestamp":"2025-06-24T10:49:45.600Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:49:47.769Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T10:54:03.248Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT co.*, c.name as client_name, c.surname as client_surname, p.name as product_name, p.supplier as product_supplier FROM contracts co JOIN clients c ON co.client_id = c.id LEFT JOIN products p ON co.product_id = p.id ORDER BY co.created_at DESC","service":"nexus-db","timestamp":"2025-06-24T10:54:03.253Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS users ( id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT UNIQUE NOT NULL, password TEXT NOT NULL, role TEXT NOT NULL, name TEXT NOT NULL, email TEXT, last_login DATETIME, failed_login_attempts INTEGER DEFAULT 0, account_locked BOOLEAN DEFAULT 0, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP )","service":"nexus-db","timestamp":"2025-06-24T11:00:15.666Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS clients ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, surname TEXT NOT NULL, company TEXT, vat_number TEXT, address TEXT, city TEXT, postal_code TEXT, phone TEXT, email TEXT, notes TEXT, consultant_id INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T11:00:15.666Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS activities ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, title TEXT NOT NULL, description TEXT, activity_date DATETIME NOT NULL, status TEXT DEFAULT 'pending', consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T11:00:15.667Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS products ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, description TEXT, energy_type TEXT NOT NULL, supplier TEXT, base_price REAL, is_active INTEGER DEFAULT 1, created_by INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (created_by) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T11:00:15.667Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS contracts ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, product_id INTEGER, contract_type TEXT NOT NULL, energy_type TEXT NOT NULL, supplier TEXT, status TEXT DEFAULT 'pending', value REAL, start_date DATE, end_date DATE, notes TEXT, consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (product_id) REFERENCES products (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T11:00:15.667Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS user_sessions ( id INTEGER PRIMARY KEY AUTOINCREMENT, user_id INTEGER NOT NULL, session_id TEXT NOT NULL, ip_address TEXT, user_agent TEXT, login_time DATETIME DEFAULT CURRENT_TIMESTAMP, logout_time DATETIME, is_active BOOLEAN DEFAULT 1, FOREIGN KEY (user_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T11:00:15.668Z"}
{"level":"debug","message":"Database query executed","method":"get","query":"SELECT * FROM users WHERE username = 'admin'","service":"nexus-db","timestamp":"2025-06-24T11:00:15.730Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["admin"],"query":"SELECT * FROM users WHERE LOWER(username) = LOWER(?)","service":"nexus-db","timestamp":"2025-06-24T11:00:24.783Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET failed_login_attempts = 0, account_locked = 0 WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:25.079Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET last_login = CURRENT_TIMESTAMP WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:25.080Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:25.091Z"}
{"level":"debug","message":"Database query executed","method":"run","params":["N4RFJ8tJ2C5Ph8dZ9psd0aQ7WVfi2jjZ",9],"query":"UPDATE user_sessions SET session_id = ? WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:25.110Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:26.384Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T11:00:26.385Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:27.916Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:47.519Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T11:00:47.520Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:52.047Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:52.050Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T11:00:57.031Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS users ( id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT UNIQUE NOT NULL, password TEXT NOT NULL, role TEXT NOT NULL, name TEXT NOT NULL, email TEXT, last_login DATETIME, failed_login_attempts INTEGER DEFAULT 0, account_locked BOOLEAN DEFAULT 0, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP )","service":"nexus-db","timestamp":"2025-06-24T12:49:50.644Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS clients ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, surname TEXT NOT NULL, company TEXT, vat_number TEXT, address TEXT, city TEXT, postal_code TEXT, phone TEXT, email TEXT, notes TEXT, consultant_id INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T12:49:50.645Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS activities ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, title TEXT NOT NULL, description TEXT, activity_date DATETIME NOT NULL, status TEXT DEFAULT 'pending', consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T12:49:50.645Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS products ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, description TEXT, energy_type TEXT NOT NULL, supplier TEXT, base_price REAL, is_active INTEGER DEFAULT 1, created_by INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (created_by) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T12:49:50.646Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS contracts ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, product_id INTEGER, contract_type TEXT NOT NULL, energy_type TEXT NOT NULL, supplier TEXT, status TEXT DEFAULT 'pending', value REAL, start_date DATE, end_date DATE, notes TEXT, consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (product_id) REFERENCES products (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T12:49:50.646Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS user_sessions ( id INTEGER PRIMARY KEY AUTOINCREMENT, user_id INTEGER NOT NULL, session_id TEXT NOT NULL, ip_address TEXT, user_agent TEXT, login_time DATETIME DEFAULT CURRENT_TIMESTAMP, logout_time DATETIME, is_active BOOLEAN DEFAULT 1, FOREIGN KEY (user_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T12:49:50.646Z"}
{"level":"debug","message":"Database query executed","method":"get","query":"SELECT * FROM users WHERE username = 'admin'","service":"nexus-db","timestamp":"2025-06-24T12:49:50.702Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["admin"],"query":"SELECT * FROM users WHERE LOWER(username) = LOWER(?)","service":"nexus-db","timestamp":"2025-06-24T12:50:02.085Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET failed_login_attempts = 0, account_locked = 0 WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:02.373Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET last_login = CURRENT_TIMESTAMP WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:02.374Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:02.388Z"}
{"level":"debug","message":"Database query executed","method":"run","params":["UCt97Pnd44FeBaUqZoZGXn2hwLvs5MHt",10],"query":"UPDATE user_sessions SET session_id = ? WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:02.392Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:04.203Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT co.*, c.name as client_name, c.surname as client_surname, p.name as product_name, p.supplier as product_supplier FROM contracts co JOIN clients c ON co.client_id = c.id LEFT JOIN products p ON co.product_id = p.id ORDER BY co.created_at DESC","service":"nexus-db","timestamp":"2025-06-24T12:50:04.205Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:06.597Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT co.*, c.name as client_name, c.surname as client_surname, p.name as product_name, p.supplier as product_supplier, p.base_price as product_base_price, p.description as product_description FROM contracts co JOIN clients c ON co.client_id = c.id LEFT JOIN products p ON co.product_id = p.id WHERE co.id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:06.598Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T12:50:06.600Z"}
{"level":"debug","message":"Database query executed","method":"all","query":"SELECT * FROM products ORDER BY name ASC","service":"nexus-db","timestamp":"2025-06-24T12:50:06.601Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:14.807Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T12:50:14.808Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:18.231Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:18.232Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:21.241Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:21.244Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM electricity_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T12:50:21.245Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM gas_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T12:50:21.246Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_kwh) as total_consumption, AVG(annual_consumption_kwh) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM electricity_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_kwh IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T12:50:21.247Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_smc) as total_consumption, AVG(annual_consumption_smc) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM gas_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_smc IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T12:50:21.248Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:35.842Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:50:35.844Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:51:11.598Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:51:11.600Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM electricity_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T12:51:11.601Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM gas_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T12:51:11.602Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_kwh) as total_consumption, AVG(annual_consumption_kwh) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM electricity_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_kwh IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T12:51:11.603Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_smc) as total_consumption, AVG(annual_consumption_smc) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM gas_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_smc IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T12:51:11.604Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:51:20.235Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:51:20.237Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:52:58.744Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:52:58.756Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM electricity_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T12:52:58.757Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM gas_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T12:52:58.758Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_kwh) as total_consumption, AVG(annual_consumption_kwh) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM electricity_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_kwh IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T12:52:58.760Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_smc) as total_consumption, AVG(annual_consumption_smc) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM gas_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_smc IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T12:52:58.761Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:54:53.599Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:54:58.739Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:54:59.801Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:55:01.530Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T12:55:01.532Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:55:03.379Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:55:03.380Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:55:06.568Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:55:06.570Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM electricity_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T12:55:06.570Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM gas_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T12:55:06.571Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_kwh) as total_consumption, AVG(annual_consumption_kwh) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM electricity_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_kwh IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T12:55:06.572Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_smc) as total_consumption, AVG(annual_consumption_smc) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM gas_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_smc IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T12:55:06.572Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:55:08.693Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:55:44.342Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T12:55:49.869Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS users ( id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT UNIQUE NOT NULL, password TEXT NOT NULL, role TEXT NOT NULL, name TEXT NOT NULL, email TEXT, last_login DATETIME, failed_login_attempts INTEGER DEFAULT 0, account_locked BOOLEAN DEFAULT 0, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP )","service":"nexus-db","timestamp":"2025-06-24T13:08:03.199Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS clients ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, surname TEXT NOT NULL, company TEXT, vat_number TEXT, address TEXT, city TEXT, postal_code TEXT, phone TEXT, email TEXT, notes TEXT, consultant_id INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T13:08:03.200Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS activities ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, title TEXT NOT NULL, description TEXT, activity_date DATETIME NOT NULL, status TEXT DEFAULT 'pending', consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T13:08:03.200Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS products ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, description TEXT, energy_type TEXT NOT NULL, supplier TEXT, base_price REAL, is_active INTEGER DEFAULT 1, created_by INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (created_by) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T13:08:03.201Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS contracts ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, product_id INTEGER, contract_type TEXT NOT NULL, energy_type TEXT NOT NULL, supplier TEXT, status TEXT DEFAULT 'pending', value REAL, start_date DATE, end_date DATE, notes TEXT, consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (product_id) REFERENCES products (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T13:08:03.201Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS user_sessions ( id INTEGER PRIMARY KEY AUTOINCREMENT, user_id INTEGER NOT NULL, session_id TEXT NOT NULL, ip_address TEXT, user_agent TEXT, login_time DATETIME DEFAULT CURRENT_TIMESTAMP, logout_time DATETIME, is_active BOOLEAN DEFAULT 1, FOREIGN KEY (user_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T13:08:03.201Z"}
{"level":"debug","message":"Database query executed","method":"get","query":"SELECT * FROM users WHERE username = 'admin'","service":"nexus-db","timestamp":"2025-06-24T13:08:03.258Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["admin"],"query":"SELECT * FROM users WHERE LOWER(username) = LOWER(?)","service":"nexus-db","timestamp":"2025-06-24T13:08:14.134Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET failed_login_attempts = 0, account_locked = 0 WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:14.407Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET last_login = CURRENT_TIMESTAMP WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:14.408Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:14.418Z"}
{"level":"debug","message":"Database query executed","method":"run","params":["hKB1FMDBPqzjEnBYMQJWMvVry_uDMIYo",11],"query":"UPDATE user_sessions SET session_id = ? WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:14.442Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:40.700Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT energy_type, COUNT(*) as count, SUM(value) as total_value FROM contracts WHERE status = 'accepted' GROUP BY energy_type","service":"nexus-db","timestamp":"2025-06-24T13:08:40.701Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:45.535Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T13:08:45.537Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:47.466Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:47.468Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:50.530Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:50.531Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM electricity_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:08:50.532Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT * FROM gas_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:08:50.534Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_kwh) as total_consumption, AVG(annual_consumption_kwh) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM electricity_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_kwh IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T13:08:50.534Z"}
{"level":"debug","message":"Database query executed","method":"all","params":["1"],"query":"SELECT COUNT(*) as total_utilities, SUM(annual_consumption_smc) as total_consumption, AVG(annual_consumption_smc) as avg_consumption, MIN(annual_consumption_year) as oldest_year, MAX(annual_consumption_year) as newest_year FROM gas_utilities WHERE client_id = ? AND is_active = 1 AND annual_consumption_smc IS NOT NULL","service":"nexus-db","timestamp":"2025-06-24T13:08:50.535Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:56.513Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:08:56.514Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM activities WHERE client_id = ? ORDER BY activity_date DESC","service":"nexus-db","timestamp":"2025-06-24T13:08:56.514Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT co.*, p.name as product_name FROM contracts co LEFT JOIN products p ON co.product_id = p.id WHERE co.client_id = ? ORDER BY co.created_at DESC","service":"nexus-db","timestamp":"2025-06-24T13:08:56.515Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM electricity_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:08:56.516Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM gas_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:08:56.517Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:09:06.616Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:09:06.617Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:09:14.679Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:09:14.681Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM activities WHERE client_id = ? ORDER BY activity_date DESC","service":"nexus-db","timestamp":"2025-06-24T13:09:14.682Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT co.*, p.name as product_name FROM contracts co LEFT JOIN products p ON co.product_id = p.id WHERE co.client_id = ? ORDER BY co.created_at DESC","service":"nexus-db","timestamp":"2025-06-24T13:09:14.683Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM electricity_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:09:14.683Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM gas_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:09:14.683Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:09:44.252Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:09:44.254Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM activities WHERE client_id = ? ORDER BY activity_date DESC","service":"nexus-db","timestamp":"2025-06-24T13:09:44.255Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT co.*, p.name as product_name FROM contracts co LEFT JOIN products p ON co.product_id = p.id WHERE co.client_id = ? ORDER BY co.created_at DESC","service":"nexus-db","timestamp":"2025-06-24T13:09:44.256Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM electricity_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:09:44.256Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM gas_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:09:44.257Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:10:58.409Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["1"],"query":"SELECT * FROM clients WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:10:58.410Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM activities WHERE client_id = ? ORDER BY activity_date DESC","service":"nexus-db","timestamp":"2025-06-24T13:10:58.410Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT co.*, p.name as product_name FROM contracts co LEFT JOIN products p ON co.product_id = p.id WHERE co.client_id = ? ORDER BY co.created_at DESC","service":"nexus-db","timestamp":"2025-06-24T13:10:58.411Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM electricity_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:10:58.412Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[1],"query":"SELECT * FROM gas_utilities WHERE client_id = ? AND is_active = 1 ORDER BY utility_name ASC, created_at ASC","service":"nexus-db","timestamp":"2025-06-24T13:10:58.412Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T13:14:56.044Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS users ( id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT UNIQUE NOT NULL, password TEXT NOT NULL, role TEXT NOT NULL, name TEXT NOT NULL, email TEXT, last_login DATETIME, failed_login_attempts INTEGER DEFAULT 0, account_locked BOOLEAN DEFAULT 0, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP )","service":"nexus-db","timestamp":"2025-06-24T14:03:24.011Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS clients ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, surname TEXT NOT NULL, company TEXT, vat_number TEXT, address TEXT, city TEXT, postal_code TEXT, phone TEXT, email TEXT, notes TEXT, consultant_id INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T14:03:24.012Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS activities ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, title TEXT NOT NULL, description TEXT, activity_date DATETIME NOT NULL, status TEXT DEFAULT 'pending', consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T14:03:24.012Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS products ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, description TEXT, energy_type TEXT NOT NULL, supplier TEXT, base_price REAL, is_active INTEGER DEFAULT 1, created_by INTEGER, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (created_by) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T14:03:24.013Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS contracts ( id INTEGER PRIMARY KEY AUTOINCREMENT, client_id INTEGER NOT NULL, product_id INTEGER, contract_type TEXT NOT NULL, energy_type TEXT NOT NULL, supplier TEXT, status TEXT DEFAULT 'pending', value REAL, start_date DATE, end_date DATE, notes TEXT, consultant_id INTEGER NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (client_id) REFERENCES clients (id), FOREIGN KEY (product_id) REFERENCES products (id), FOREIGN KEY (consultant_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T14:03:24.013Z"}
{"level":"debug","message":"Database query executed","method":"run","query":"CREATE TABLE IF NOT EXISTS user_sessions ( id INTEGER PRIMARY KEY AUTOINCREMENT, user_id INTEGER NOT NULL, session_id TEXT NOT NULL, ip_address TEXT, user_agent TEXT, login_time DATETIME DEFAULT CURRENT_TIMESTAMP, logout_time DATETIME, is_active BOOLEAN DEFAULT 1, FOREIGN KEY (user_id) REFERENCES users (id) )","service":"nexus-db","timestamp":"2025-06-24T14:03:24.013Z"}
{"level":"debug","message":"Database query executed","method":"get","query":"SELECT * FROM users WHERE username = 'admin'","service":"nexus-db","timestamp":"2025-06-24T14:03:24.077Z"}
{"level":"debug","message":"Database query executed","method":"get","params":["admin"],"query":"SELECT * FROM users WHERE LOWER(username) = LOWER(?)","service":"nexus-db","timestamp":"2025-06-24T14:03:35.327Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET failed_login_attempts = 0, account_locked = 0 WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:03:35.631Z"}
{"level":"debug","message":"Database query executed","method":"run","params":[1],"query":"UPDATE users SET last_login = CURRENT_TIMESTAMP WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:03:35.632Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:03:35.641Z"}
{"level":"debug","message":"Database query executed","method":"run","params":["ugcUh9NdpgFazs3GZSoN7DgKr0dycvMJ",12],"query":"UPDATE user_sessions SET session_id = ? WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:03:35.664Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:03:39.321Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T14:03:39.322Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:03:41.599Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:04:17.212Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:04:19.856Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:06:12.250Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:06:13.972Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T14:06:13.973Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:06:15.973Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:06:30.803Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:06:57.375Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:07:12.306Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:07:20.535Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T14:07:20.578Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:07:22.632Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT a.*, c.name as client_name, c.surname as client_surname FROM activities a JOIN clients c ON a.client_id = c.id ORDER BY a.activity_date DESC","service":"nexus-db","timestamp":"2025-06-24T14:07:22.635Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:07:25.292Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T14:07:25.293Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:07:28.649Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT co.*, c.name as client_name, c.surname as client_surname, p.name as product_name, p.supplier as product_supplier FROM contracts co JOIN clients c ON co.client_id = c.id LEFT JOIN products p ON co.product_id = p.id ORDER BY co.created_at DESC","service":"nexus-db","timestamp":"2025-06-24T14:07:28.650Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:07:30.324Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT id, name, surname, company, vat_number, fiscal_code, company_fiscal_code, phone, email, pec_email, city, province, client_status, last_contact_date, created_at FROM clients ORDER BY name ASC, surname ASC","service":"nexus-db","timestamp":"2025-06-24T14:07:30.325Z"}
{"level":"debug","message":"Database query executed","method":"all","query":"SELECT * FROM products WHERE is_active = 1 ORDER BY name ASC","service":"nexus-db","timestamp":"2025-06-24T14:07:30.327Z"}
{"level":"debug","message":"Database query executed","method":"get","params":[1],"query":"SELECT id, username, role, name, email, last_login, failed_login_attempts, account_locked, created_at FROM users WHERE id = ?","service":"nexus-db","timestamp":"2025-06-24T14:07:38.699Z"}
{"level":"debug","message":"Database query executed","method":"all","params":[],"query":"SELECT energy_type, COUNT(*) as count, SUM(value) as total_value FROM contracts WHERE status = 'accepted' GROUP BY energy_type","service":"nexus-db","timestamp":"2025-06-24T14:07:38.700Z"}
